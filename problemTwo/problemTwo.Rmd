---
title: "problemTwo"
author: "Daniel Emaasit"
date: "February 24, 2015"
output: html_document
---

# Problem C17.5
Using the data in FERTIL1.RAW. 

## Part (i)
Estimate a poisson regression model for kids, using the same variables in TABLE 13.1. Interpret the coefficient on y82.

```{r}
# read the data into R
library(haven)
fertile_data<-read_dta("FERTIL1.dta")


# estimate a poisson regression model
library(MASS)
model1<-glm(kids~., family="poisson", data=fertile_data)
library(stargazer)
stargazer(model1)

````

## Part (ii)
What is the estimated percentage difference in fertility between a black woman and 
a non black woman, holding other factors fixed?

```{r}


````

## Part (iii)
Obtain the estimated standard deviation Is there evidence of over or underdispersion?

```{r}


````

## Part (iv)
Compute the fitted values from the Posson regression and obtain the R-squared as the squared
correlation betweein kids and estimated kids. Compare this with the R-squared for the linear regression model

```{r}


````

# Problem C17.9
Use the data in APPLE.RAW for this exercise. 

## Part (i)
Of the 660 families in the sample, how many report wanting none of the eco-labeled
apples at the set price?

```{r}
# read the data into R
apple_data<-read_dta("APPLE.dta")

# count the no of families wanting none of the ecolabeled apples
library(dplyr)
apple_data %>% filter(ecolbs==0) %>% count()
````

248 families report wanting none of the eco-labelled apples at the set price

## Part (ii)
Does the variable ecolbs seem to have a continous distribution over strictly positive
values? What implications does your answer have for the suitability of a Tobit model
for ecolbs?

```{r}
# look at a sample of the data
head(apple_data$ecolbs, n=10)
````

The variable ecolbs does not have a continous distribution. This type of distribution violates the latent variable formulation underlying the Tobit model.

## Part (iii)
Estimate a Tobit model for ecolbs with ecoprc, regprc, faminc, and hhsize as explanatory variables. Which variables are significant at the 1% level?

```{r}
# estimate a Tobit model
library(AER)
tobit_model1<-tobit(ecolbs~ecoprc+regprc+faminc+hhsize, data=apple_data)
stargazer(tobit_model1, type="text")

````

The variables significant at the 1% level include: 

## Part (iv)
Are faminc and hhsize jointly significant?
```{r}



````

## Part (v)
Are the signs of the coeffficient on the price variables from part(iii) what you expect? Explain

The signs are as expected because as the price of the product increases the demand decreases

## Part (vi)
Test the hypothesis.
```{r}
# calculate the t value
calculated_t_value<-(-5.705+5.525)/(0.885+1.066)
calculated_t_value
````

The rule: Reject the null hypothesis if |calculated t value|>|critical t value|,

The decision: since the |calculated.t.value|<1.96, we FAIL to reject the null hypothesis

The inference: The ecopric is equal to the negative value of regprc

## Part (vii)
Obtain the estimates of E(ecolbs|x) for all observations in the sample. what are the smallest and largest values?

```{r}
# predict the estimates
estimated_ecolbs<-predict(tobit_model1, type="response",apple_data)

# find the range in the estimated values
range(estimated_ecolbs)
````

## Part (viii)
Compute the squared correlation between ecolbs and estimated ecolbs.

```{r}
# find the squared correlation between the actual and estimated values
cor(apple_data$ecolbs,estimated_ecolbs)^2
````

## Part (ix)
Now, estimate a linear model for ecolbs using the same explanatory variables from part (iii). Why are the OLS estimates so much smaller than the Tobit estimates? In terms of goodness-of-fit, is the Tobit model better than the linear model?

```{r}
# estimate a linear model
linear_model<-lm(ecolbs~ecoprc+regprc+faminc+hhsize, data=apple_data)
stargazer(linear_model, type = "text")

````

The OLS estimates are so much smaller because they are not scaled like the Tobit estimates. The OLS model fits this data better because its R-squared value is greater i.e 0.046 compared to 0.044

## Part (x)
Evaluate the following statement: "Because the R-squared from the Tobit model is so small, the estimated price effects are probably inconsisent."

I think this statement is incorrent.  

# Problem C17.10
Use the data in SMOKE.RAW for this exercise. 

## Part (i)
How many people in the sample do not smoke at all? what fraction of people claim to smoke 20 cigarettes a day? Why do you think there is a pile up of people at 20 cigarettes?

```{r}
# read the data into R
smoke_data<-read_dta("SMOKE.dta")

# count the number of people who do not smoke
smoke_data %>% filter(cigs==0) %>% count()

# count the number of people who smoke 20 cigarettes
smoke_data %>% filter(cigs==20) %>% count()
````

Apparently there are 20 cigarettes in a pack, so that could be a reason why there's a pile up.

## Part (ii)
Does cigs seem a good candidate for having a condidtional Poisson distribution?

No, cigs does not seem a good candidate because Poisson distribution does not allow for such focal points that in the cigs variable.

## Part (iii)
Estimate a Poisson regression model for cigs, including log(cigpric), log(income),white, educ, age, and age2 as explanatory variables. What are the estimated price and income elasticities??

```{r}
# convert string variables to factor variables



# estimate a poisson regression model
poisson_model2<-glm(cigs~lcigpric+lincome+white+educ+age+agesq, family="poisson", data=smoke_data)


````

## Part (iv)
Using the maximum likelihood standard errors, are the price and income variables sististically significant at the 5% level?

```{r}


````

## Part (v)
Obtain the estimate of the variance. What is the estimated standard deviation? How should you adjust the standard errors from part (iv)?

```{r}


````

## Part (vi)
Using the adjusted standard errors, are the price and income elasticities now statistically different from zero? Explain.

```{r}


````

## Part (vii)
Are the education and age variables significant using the more robust standard errors? How do interpret the coefficient on educ?

```{r}


````

## Part (viii)
obtained the fitted values from the poisson regression model. Find the minimum and maximum values.

```{r}


````

## Part (ix)
Using the fitted values from part (viii), obtain the squared correlation coefficient between esimated y and y.

```{r}


````

## Part (x)
Estimate a linea model for cigs by OLS, using the explanatory variables

```{r}


````
